<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Evolve.AI — Medford Private Beta</title>
  <style>
    :root {
      --bg: #0d1117;
      --card: #161b22;
      --muted: #8b949e;
      --accent: #1f6feb;
      --accent2: #00c2ff;
      --text: #c9d1d9;
      --radius: 12px;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--text); }
    a { color: inherit; text-decoration: none; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 18px; }
    .header { display: flex; justify-content: space-between; align-items: center; gap: 12px; }
    .brand { display: flex; gap: 10px; align-items: center; }
    .logo {
      width: 40px; height: 40px; border-radius: 10px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-weight: 800; box-shadow: 0 0 12px rgba(0,194,255,.35);
    }
    .muted { color: var(--muted); font-size: 13px; }
    .btn {
      background: var(--accent); color: #fff; border: 0;
      padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600;
      box-shadow: 0 0 10px var(--accent2), 0 0 20px rgba(0,194,255,.25);
      transition: all .2s;
    }
    .btn:hover { transform: translateY(-1px); }
    .btn.ghost {
      background: transparent; color: var(--accent);
      border: 1px solid rgba(0,194,255,.5);
      box-shadow: none;
    }
    nav { display: flex; gap: 10px; flex-wrap: wrap; }
    nav a { padding: 8px 12px; border-radius: 10px; border: 1px solid transparent; }
    nav a.active { border-color: var(--accent2); background: var(--card); }
    .grid { display: grid; grid-template-columns: 1fr 360px; gap: 14px; }
    .card {
      background: var(--card); border-radius: 14px; padding: 16px;
      box-shadow: 0 8px 20px rgba(0,194,255,.1);
    }
    .kpis { display: grid; grid-template-columns: repeat(3,1fr); gap: 12px; }
    .kpi { padding: 12px; border-radius: 12px; background: #0d1117; border: 1px solid #1f6feb33; }
    .exercise, .meal {
      padding: 12px; border-radius: 10px;
      background: #0d1117; border: 1px solid #1f6feb33; margin-bottom: 10px;
    }
    details { background: #0d1117; border: 1px solid #1f6feb33; padding: 8px; border-radius: 10px; margin-top: 6px; }
    .form label { font-size: 12px; color: var(--muted); }
    .form input, .form select {
      width: 100%; padding: 10px; border: 1px solid #30363d;
      border-radius: 10px; background: #0d1117; color: var(--text);
      margin-top: 6px; margin-bottom: 10px;
    }
    @media (max-width:960px) { .grid { grid-template-columns: 1fr; } .kpis { grid-template-columns: 1fr; } }
    .plans { display: grid; grid-template-columns: repeat(3,1fr); gap: 14px; }
    .plan { border: 1px solid #30363d; border-radius: 14px; padding: 16px; background: #0d1117; }
    .plan h3 { margin: 0 0 6px 0; }
    .price { font-size: 28px; font-weight: 800; color: var(--accent2); }
    .check { color: #10b981; font-weight: 700; }
    .cross { color: #ef4444; font-weight: 700; }
    @media (max-width:900px){.plans{grid-template-columns:1fr}}
    .gallery { display: grid; grid-template-columns: repeat(3,1fr); gap: 14px; }
    .tile { background: #0d1117; border: 1px solid #1f6feb33; border-radius: 14px; padding: 12px; }
    .before,.after {
      height: 140px; border-radius: 10px; display:flex; align-items:center; justify-content:center; font-weight: 700;
    }
    .before { background: linear-gradient(45deg,#222,#333); color: #999; }
    .after { background: linear-gradient(45deg,#1f6feb,#00c2ff); color: #fff; }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header -->
    <div class="header">
      <div class="brand">
        <div class="logo">EA</div>
        <div>
          <div style="font-weight:800">Evolve.AI</div>
          <div class="muted">Medford Private Beta · Aug 17, 2025</div>
        </div>
      </div>
      <nav>
        <a href="#/dashboard" id="link-dashboard" class="active">Dashboard</a>
        <a href="#/pricing" id="link-pricing">Pricing</a>
        <a href="#/transformations" id="link-transformations">Transformations</a>
      </nav>
      <div class="row" style="display:flex; gap:8px">
        <button class="btn" onclick="generatePlan()">Generate Plan</button>
        <button class="btn ghost" onclick="testPing()">Test Ping</button>
      </div>
    </div>

    <!-- DASHBOARD -->
    <section id="page-dashboard">
      <div class="grid" style="margin-top:14px">
        <div>
          <!-- KPI row -->
          <div class="kpis">
            <div class="kpi">
              <div class="muted">Calories Remaining</div>
              <canvas id="donut" width="240" height="140" style="width:100%"></canvas>
              <div class="muted" id="kcalText">Target 2200 kcal</div>
            </div>
            <div class="kpi">
              <div class="muted">Workout Completion</div>
              <div style="height:18px;border-radius:10px;background:#1f2937;overflow:hidden">
                <div id="progressBar" style="height:18px;width:42%;background:linear-gradient(90deg,#1f6feb,#00c2ff)"></div>
              </div>
              <div class="muted" id="progressText" style="margin-top:6px">3 / 7 sessions</div>
            </div>
            <div class="kpi">
              <div class="muted">This Week</div>
              <div id="weekSummary" style="font-weight:700;font-size:22px;margin-top:8px">2,150 avg kcal · 4 workouts planned</div>
              <div class="muted">Auto-adjusts from your logs</div>
            </div>
          </div>

          <!-- Today’s workout -->
          <div class="card" style="margin-top:12px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-weight:700;font-size:18px">Today's Workout</div>
                <div id="workoutMeta" class="muted">Smart mock • 50–60 min</div>
              </div>
              <div class="muted" id="weekBadge">Week 1 • Day 1</div>
            </div>
            <div id="exerciseList"></div>
          </div>

          <!-- Today’s meals -->
          <div class="card" style="margin-top:12px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-weight:700;font-size:18px">Today's Meals</div>
                <div class="muted">Calories target: <b id="calTarget">2200</b> kcal</div>
              </div>
              <div class="muted" id="dietBadge">Balanced</div>
            </div>
            <div id="mealGrid"></div>
          </div>

          <!-- Activity feed + Debug -->
          <div class="card" style="margin-top:12px">
            <div style="font-weight:700">Recent Activity</div>
            <div class="muted">Latest logs</div>
            <div id="feed" style="display:flex;flex-direction:column;gap:6px;margin-top:8px"></div>
            <pre id="planJson" style="white-space:pre-wrap;max-height:260px;overflow:auto;background:#0b10211a;padding:10px;border-radius:10px;margin-top:10px"></pre>
          </div>

          <div class="card" style="margin-top:12px">
            <div style="font-weight:700">Debug</div>
            <pre id="debugLog" style="white-space:pre-wrap;max-height:240px;overflow:auto;background:#0b10211a;padding:10px;border-radius:10px;margin-top:8px">Ready…</pre>
          </div>
        </div>

        <!-- Profile (enhanced onboarding) -->
        <aside>
          <div class="card">
            <div style="font-weight:700">Your Profile</div>
            <div class="muted">Tell Evolve.AI how to tailor your plan</div>

            <!-- Basics -->
            <div class="form" style="margin-top:8px">
              <div style="font-weight:700;margin-bottom:4px">Basics</div>
              <label>Age<input id="age" type="number" value="28" min="13" max="90"></label>
              <label>Sex
                <select id="sex"><option>male</option><option>female</option><option>other</option></select>
              </label>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
                <label>Height — Feet<input id="height_ft" type="number" value="5" min="3" max="7"></label>
                <label>Height — Inches<input id="height_in" type="number" value="10" min="0" max="11"></label>
              </div>
              <label>Weight (lb)<input id="weight_lb" type="number" value="176" min="70" max="500"></label>
            </div>

            <!-- Goals & Lifestyle -->
            <div class="form" style="margin-top:8px">
              <div style="font-weight:700;margin-bottom:4px">Goals & Lifestyle</div>
              <label>What are you training for?
                <select id="training_for">
                  <option value="fat loss">Fat loss</option>
                  <option value="muscle gain">Muscle gain</option>
                  <option value="general fitness" selected>General fitness</option>
                  <option value="sports performance">Sports performance</option>
                  <option value="rehab">Injury rehab / return to play</option>
                  <option value="longevity">Longevity & healthspan</option>
                  <option value="aesthetics">Aesthetics / recomposition</option>
                </select>
              </label>
              <label>Do you play any sports? (comma)
                <input id="sports" placeholder="soccer, basketball">
              </label>
              <label>Lifestyle activity
                <select id="activity_level">
                  <option>sedentary</option>
                  <option>light</option>
                  <option selected>moderate</option>
                  <option>very active</option>
                </select>
              </label>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
                <label>Preferred training time
                  <select id="training_time">
                    <option>morning</option><option>midday</option><option selected>evening</option>
                  </select>
                </label>
                <label>Session length
                  <select id="session_length">
                    <option>30 min</option><option selected>45 min</option><option>60 min</option><option>90 min</option>
                  </select>
                </label>
              </div>
              <label>Days per week<input id="days" type="number" value="5" min="2" max="7"></label>
              <label>Equipment access
                <select id="equipment_access">
                  <option selected>full gym</option>
                  <option>home gym</option>
                  <option>limited equipment</option>
                  <option>no equipment</option>
                </select>
              </label>
              <label>Equipment list (comma)
                <input id="equip" value="dumbbells, barbell, bench">
              </label>
            </div>

            <!-- Limitations & Safety -->
            <div class="form" style="margin-top:8px">
              <div style="font-weight:700;margin-bottom:4px">Limitations & Safety</div>
              <label>Injuries or movement limits (comma)
                <input id="injuries" placeholder="knee pain, lower back">
              </label>
              <label>Medical conditions (optional)
                <input id="medical" placeholder="hypertension, asthma">
              </label>
            </div>

            <!-- Nutrition & Recovery -->
            <div class="form" style="margin-top:8px">
              <div style="font-weight:700;margin-bottom:4px">Nutrition & Recovery</div>
              <label>Diet style
                <select id="diet">
                  <option selected>balanced</option>
                  <option>high protein</option>
                  <option>lower carb</option>
                  <option>vegetarian</option>
                  <option>pescatarian</option>
                  <option>plant-based</option>
                  <option>paleo</option>
                  <option>keto</option>
                </select>
              </label>
              <label>Food allergies (comma)<input id="allergies" placeholder="peanuts, shellfish"></label>
              <label>Food dislikes / restrictions (comma)<input id="food_dislikes" placeholder="no seafood, no dairy"></label>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
                <label>Calories / day<input id="cal" type="number" value="2200" min="1200" max="4500"></label>
                <label>Sleep (hrs/night)<input id="sleep_hours" type="number" value="7" min="3" max="12"></label>
              </div>
              <label>Stress level
                <select id="stress_level">
                  <option>low</option><option selected>medium</option><option>high</option>
                </select>
              </label>
            </div>

            <!-- Motivation & Tracking -->
            <div class="form" style="margin-top:8px">
              <div style="font-weight:700;margin-bottom:4px">Motivation & Tracking</div>
              <label>Why now?
                <select id="motivation">
                  <option>personal health</option>
                  <option>appearance / confidence</option>
                  <option>performance / competition</option>
                  <option selected>consistency & accountability</option>
                </select>
              </label>
              <label>How to track progress?
                <select id="tracking_pref">
                  <option>scale weight</option>
                  <option selected>strength PRs</option>
                  <option>body measurements</option>
                  <option>photos</option>
                  <option>endurance metrics</option>
                  <option>energy / mood</option>
                </select>
              </label>
              <label>Accountability reminders
                <select id="reminders">
                  <option>none</option>
                  <option selected>weekly summary</option>
                  <option>daily nudges</option>
                </select>
              </label>
            </div>

            <button class="btn" style="width:100%;margin-top:6px" onclick="generatePlan()">Generate Plan</button>
          </div>
        </aside>
      </div>
    </section>

    <!-- PRICING -->
    <section id="page-pricing" style="display:none;margin-top:14px">
      <div class="card" style="margin-bottom:12px">
        <div style="font-weight:800;font-size:22px;margin-bottom:4px">Plans designed to grow with you</div>
        <div class="muted">Transparent. Cancel anytime.</div>
      </div>
      <div class="plans">
        <div class="plan">
          <h3>Starter</h3>
          <div class="price">$0</div>
          <div class="muted">Try Evolve.AI with basic features</div>
          <ul>
            <li class="check">AI weekly plan</li>
            <li class="check">Recipe macros</li>
            <li class="cross">No wearables</li>
            <li class="cross">No coach chat</li>
          </ul>
          <button class="btn ghost" onclick="alert('Mock: Sign up flow')">Get started</button>
        </div>
        <div class="plan" style="border:2px solid var(--accent)">
          <h3>Pro</h3>
          <div class="price">$9.99<span class="muted" style="font-size:12px">/mo</span></div>
          <div class="muted">Everything you need to stay consistent</div>
          <ul>
            <li class="check">Adaptive weekly plans</li>
            <li class="check">Swap meals & workouts</li>
            <li class="check">Wearable sync (coming)</li>
            <li class="check">AI coach chat (beta)</li>
          </ul>
          <button class="btn" onclick="alert('Mock: Checkout')">Start free trial</button>
        </div>
        <div class="plan">
          <h3>Coach</h3>
          <div class="price">$39<span class="muted" style="font-size:12px">/mo</span></div>
          <div class="muted">For power users & athletes</div>
          <ul>
            <li class="check">Periodized programming</li>
            <li class="check">Coach feedback</li>
            <li class="check">Form video notes</li>
          </ul>
          <button class="btn" style="background:var(--accent2)" onclick="alert('Mock: Contact sales')">Talk to us</button>
        </div>
      </div>
    </section>

    <!-- TRANSFORMATIONS -->
    <section id="page-transformations" style="display:none;margin-top:14px">
      <div class="card" style="margin-bottom:12px">
        <div style="font-weight:800;font-size:22px;margin-bottom:4px">Real change, measurable progress</div>
        <div class="muted">Evolve.AI adapts to your life, equipment, and preferences.</div>
      </div>
      <div class="gallery">
        <div class="tile">
          <div class="before">Before</div>
          <div class="after" style="margin-top:8px">After (8 wks)</div>
          <div style="font-weight:700;margin-top:8px">Sarah —12 lb</div>
          <div class="muted">“Meals were easy to follow. Workouts scaled perfectly.”</div>
        </div>
        <div class="tile">
          <div class="before">Before</div>
          <div class="after" style="margin-top:8px">After (10 wks)</div>
          <div style="font-weight:700;margin-top:8px">Ryan +45 lb DL</div>
          <div class="muted">“Loved the strength focus + calorie targets.”</div>
        </div>
        <div class="tile">
          <div class="before">Before</div>
          <div class="after" style="margin-top:8px">After (6 wks)</div>
          <div style="font-weight:700;margin-top:8px">Priya —2" waist</div>
          <div class="muted">“Felt personalized day one. Kept me consistent.”</div>
        </div>
      </div>
    </section>
  </div>

<script>
  // -------- Routing --------
  const pages = {
    '#/dashboard': 'page-dashboard',
    '#/pricing': 'page-pricing',
    '#/transformations': 'page-transformations'
  };
  function syncRoute(){
    const hash = location.hash || '#/dashboard';
    for (const k in pages) document.getElementById(pages[k]).style.display = (k===hash)?'block':'none';
    for (const id of ['link-dashboard','link-pricing','link-transformations']){
      document.getElementById(id).classList.toggle('active', ('#/'+id.split('-')[1])===hash);
    }
  }
  window.addEventListener('hashchange', syncRoute);

  // -------- Visuals --------
  function donut(ctx, used, target){
    const w = ctx.canvas.width, h = ctx.canvas.height, r = Math.min(w,h)/2 - 10, cx = w/2, cy = h/2;
    const pct = Math.max(0, Math.min(1, used/target));
    ctx.clearRect(0,0,w,h);
    ctx.lineWidth = 16; ctx.strokeStyle = "#1f2937";
    ctx.beginPath(); ctx.arc(cx, cy, r, 0, 2*Math.PI); ctx.stroke();
    ctx.strokeStyle = "#1f6feb";
    ctx.beginPath(); ctx.arc(cx, cy, r, -Math.PI/2, -Math.PI/2 + 2*Math.PI*pct); ctx.stroke();
    ctx.fillStyle="#c9d1d9"; ctx.font="600 18px Inter, system-ui, sans-serif"; ctx.textAlign="center"; ctx.textBaseline="middle";
    const remain = Math.max(0, target - used); ctx.fillText(remain + " kcal", cx, cy);
  }

  // -------- Helpers --------
  function dlog(){ const el = document.getElementById('debugLog'); const line=[...arguments].map(a=>typeof a==='string'?a:JSON.stringify(a)).join(' '); el.textContent=(el.textContent?el.textContent+'\n':'')+line; }
  function ftInToCm(ft, inch){ const totalIn = (Number(ft)||0)*12 + (Number(inch)||0); return Math.round(totalIn*2.54); }
  function lbToKg(lb){ return Math.round((Number(lb)||0) * 0.453592 * 10) / 10; }
  function splitList(id){ return (document.getElementById(id).value||'').split(',').map(s=>s.trim()).filter(Boolean); }

  // If you host HTML on GitHub Pages, set your Netlify site below:
  const NETLIFY_URL = 'https://evolveaigm.netlify.app'; // ← replace YOUR-SITE if NOT hosting HTML on Netlify

  async function testPing(){
    const endpoint = location.hostname.endsWith('netlify.app')
      ? '/.netlify/functions/ping'
      : NETLIFY_URL + '/.netlify/functions/ping';
    dlog('Ping →', endpoint);
    try { const r = await fetch(endpoint); dlog('Ping status:', r.status); dlog('Ping body:', await r.text()); }
    catch(e){ dlog('Ping error:', String(e)); }
  }

  // -------- Generate Plan (calls Netlify function) --------
  async function generatePlan(){
    const profile = {
      age: Number(document.getElementById('age').value||28),
      sex: document.getElementById('sex').value,
      height_cm: ftInToCm(document.getElementById('height_ft').value, document.getElementById('height_in').value),
      weight_kg: lbToKg(document.getElementById('weight_lb').value),
      training_for: document.getElementById('training_for').value,
      goal: document.getElementById('training_for').value,
      sports: splitList('sports'),
      activity_level: document.getElementById('activity_level').value,
      training_time: document.getElementById('training_time').value,
      session_length: document.getElementById('session_length').value,
      days_per_week: Number(document.getElementById('days').value||5),
      equipment_access: document.getElementById('equipment_access').value,
      equipment: splitList('equip'),
      injuries: splitList('injuries'),
      medical: splitList('medical'),
      diet_style: document.getElementById('diet').value,
      allergies: splitList('allergies'),
      food_dislikes: splitList('food_dislikes'),
      calorie_target: Number(document.getElementById('cal').value||2200),
      sleep_hours: Number(document.getElementById('sleep_hours').value||7),
      stress_level: document.getElementById('stress_level').value,
      motivation: document.getElementById('motivation').value,
      tracking_pref: document.getElementById('tracking_pref').value,
      reminders: document.getElementById('reminders').value
    };

    const endpoint = location.hostname.endsWith('netlify.app')
      ? '/.netlify/functions/generate-plan'
      : NETLIFY_URL + '/.netlify/functions/generate-plan';

    dlog('Generate → POST', endpoint);
    dlog('Profile:', profile);

    try{
      const res = await fetch(endpoint, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(profile)
      });
      const txt = await res.text();
      dlog('Status:', res.status);
      dlog('Raw response:', txt);

      if(!res.ok){ document.getElementById('planJson').textContent = `Error ${res.status}:\n` + txt; alert('Server error. See Debug/JSON panels.'); return; }

      let data;
      try { data = JSON.parse(txt); }
      catch(e){ document.getElementById('planJson').textContent = 'Bad JSON from server:\n' + txt; alert('Bad JSON from server. See Debug/JSON panels.'); return; }

      const day1 = data?.week?.[0] || { workouts: [], meals: [], focus: 'full' };

      // Workouts
      document.getElementById('exerciseList').innerHTML = (day1.workouts||[]).map(x =>
        `<div class='exercise'><div><div style='font-weight:600'>${x.exercise}</div><div class='muted'>${x.sets} × ${x.reps} • ${x.rest_sec || 60}s rest</div></div><button class='btn ghost' onclick='alert("Form cues coming soon")'>Demo</button></div>`
      ).join('');
      document.getElementById('workoutMeta').textContent = `${day1.focus || 'training'} • ${profile.session_length}`;

      // Meals
      document.getElementById('calTarget').textContent = profile.calorie_target;
      document.getElementById('dietBadge').textContent = profile.diet_style.replace(/\b\w/g, c=>c.toUpperCase());
      document.getElementById('mealGrid').innerHTML = (day1.meals||[]).map(m =>
        `<div class='meal'>
           <div style='font-weight:600'>${m.name || 'Meal'}</div>
           <div class='muted'>${m.kcal || 0} kcal • P:${m.protein_g || 0}g • C:${m.carbs_g || 0}g • F:${m.fat_g || 0}g</div>
           <details><summary>Recipe & macros</summary>
             <ul>${(m.ingredients||[]).map(i=>'<li>'+i+'</li>').join('')}</ul>
             <ol>${(m.instructions||[]).map(i=>'<li>'+i+'</li>').join('')}</ol>
           </details>
         </div>`
      ).join('');

      // Donut KPI
      const used = Math.round((day1.meals||[]).reduce((s,m)=>s+(m.kcal||0),0)*0.75);
      const ctx = document.getElementById('donut').getContext('2d');
      donut(ctx, used, profile.calorie_target);

      // Progress mock
      const completed = Math.min(7, Math.floor(Math.random()*5)+2);
      document.getElementById('progressBar').style.width = Math.round((completed/7)*100) + '%';
      document.getElementById('progressText').textContent = `${completed} / 7 sessions`;
      document.getElementById('weekSummary').textContent = `${Math.round(profile.calorie_target*0.98)} avg kcal · ${profile.days_per_week} workouts planned`;

      // JSON and feed
      document.getElementById('planJson').textContent = JSON.stringify({profile, plan:data}, null, 2);
      const row = document.createElement('div'); row.className='muted';
      row.textContent = new Date().toLocaleTimeString() + ' — Generated plan via function';
      document.getElementById('feed').prepend(row);

    }catch(e){
      dlog('Fetch error:', String(e));
      document.getElementById('planJson').textContent = 'Fetch error:\n' + String(e);
      alert('Network error. See Debug/JSON panels.');
    }
  }

  // -------- First paint --------
  (function init(){
    syncRoute();
    const donutCtx = document.getElementById('donut').getContext('2d');
    donut(donutCtx, 1200, 2200);
    document.getElementById('exerciseList').innerHTML =
      '<div class="exercise"><div><div style="font-weight:600">Bench Press</div><div class="muted">4 × 6–8 • 90s rest</div></div><button class="btn ghost">Demo</button></div>';
    document.getElementById('mealGrid').innerHTML =
      '<div class="meal"><div style="font-weight:600">Breakfast</div><div class="muted">Press Generate to view personalized meals</div></div>';
  })();
</script>
</body>
</html>
